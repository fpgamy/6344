load('training_dorm0.mat')
X0 = XTrain;
Y0 = YTrain;
load('training_dorm1.mat')
X1 = XTrain;
Y1 = YTrain;
load('training_dorm2.mat')
X2 = XTrain;
Y2 = YTrain;
load('training_dorm3.mat')
X3 = XTrain;
Y3 = YTrain;
load('training_dorm4.mat')
X4 = XTrain;
Y4 = YTrain;
load('training_dorm5.mat')
X5 = XTrain;
Y5 = YTrain;
load('training_dorm6.mat')
X6 = XTrain;
Y6 = YTrain;
load('training_dorm7.mat')
X7 = XTrain;
Y7 = YTrain;
load('training_dorm8.mat')
X8 = XTrain;
Y8 = YTrain;
load('training_dorm9.mat')
X9 = XTrain;
Y9 = YTrain;
load('training_dorm10.mat')
X10 = XTrain;
Y10 = YTrain;
load('training_dorm11.mat')
X11 = XTrain;
Y11 = YTrain;
load('training_dorm12.mat')
X12 = XTrain;
Y12 = YTrain;
load('training_dorm13.mat')
X13 = XTrain;
Y13 = YTrain;
load('training_dorm14.mat')
X14 = XTrain;
Y14 = YTrain;
load('training_dorm15.mat')
X15 = XTrain;
Y15 = YTrain;
load('training_dorm16.mat')
X16 = XTrain;
Y16 = YTrain;
load('training_dorm17.mat')
X17 = XTrain;
Y17 = YTrain;
load('training_dorm18.mat')
X18 = XTrain;
Y18 = YTrain;
load('training_dorm19.mat')
X19 = XTrain;
Y19 = YTrain;
load('training_dorm20.mat')
X20 = XTrain;
Y20 = YTrain;
load('training_dorm21.mat')
X21 = XTrain;
Y21 = YTrain;
load('training_dorm22.mat')
X22 = XTrain;
Y22 = YTrain;
load('training_dorm23.mat')
X23 = XTrain;
Y23 = YTrain;
load('training_dorm24.mat')
X24 = XTrain;
Y24 = YTrain;
load('training_dorm25.mat')
X25 = XTrain;
Y25 = YTrain;
load('training_dorm26.mat')
X26 = XTrain;
Y26 = YTrain;
load('training_dorm27.mat')
X27 = XTrain;
Y27 = YTrain;
load('training_dorm28.mat')
X28 = XTrain;
Y28 = YTrain;
load('training_dorm29.mat')
X29 = XTrain;
Y29 = YTrain;
load('training_dorm30.mat')
X30 = XTrain;
Y30 = YTrain;
load('training_dorm31.mat')
X31 = XTrain;
Y31 = YTrain;
load('training_dorm32.mat')
X32 = XTrain;
Y32 = YTrain;
load('training_dorm33.mat')
X33 = XTrain;
Y33 = YTrain;
load('training_dorm34.mat')
X34 = XTrain;
Y34 = YTrain;
load('training_dorm35.mat')
X35 = XTrain;
Y35 = YTrain;
load('training_dorm36.mat')
X36 = XTrain;
Y36 = YTrain;
load('training_dorm37.mat')
X37 = XTrain;
Y37 = YTrain;
load('training_dorm38.mat')
X38 = XTrain;
Y38 = YTrain;
load('training_dorm39.mat')
X39 = XTrain;
Y39 = YTrain;
load('training_dorm40.mat')
X40 = XTrain;
Y40 = YTrain;
load('training_dorm41.mat')
X41 = XTrain;
Y41 = YTrain;
load('training_dorm42.mat')
X42 = XTrain;
Y42 = YTrain;
load('training_dorm43.mat')
X43 = XTrain;
Y43 = YTrain;
load('training_dorm44.mat')
X44 = XTrain;
Y44 = YTrain;
load('training_dorm45.mat')
X45 = XTrain;
Y45 = YTrain;
load('training_dorm46.mat')
X46 = XTrain;
Y46 = YTrain;
load('training_dorm47.mat')
X47 = XTrain;
Y47 = YTrain;
load('training_dorm48.mat')
X48 = XTrain;
Y48 = YTrain;
load('training_dorm49.mat')
X49 = XTrain;
Y49 = YTrain;
load('training_dorm50.mat')
X50 = XTrain;
Y50 = YTrain;
load('training_dorm51.mat')
X51 = XTrain;
Y51 = YTrain;
load('training_dorm52.mat')
X52 = XTrain;
Y52 = YTrain;
load('training_dorm53.mat')
X53 = XTrain;
Y53 = YTrain;
load('training_dorm54.mat')
X54 = XTrain;
Y54 = YTrain;
load('training_dorm55.mat')
X55 = XTrain;
Y55 = YTrain;
load('training_dorm56.mat')
X56 = XTrain;
Y56 = YTrain;
load('training_dorm57.mat')
X57 = XTrain;
Y57 = YTrain;
load('training_dorm58.mat')
X58 = XTrain;
Y58 = YTrain;
load('training_dorm59.mat')
X59 = XTrain;
Y59 = YTrain;
load('training_dorm60.mat')
X60 = XTrain;
Y60 = YTrain;
load('training_dorm61.mat')
X61 = XTrain;
Y61 = YTrain;
load('training_dorm62.mat')
X62 = XTrain;
Y62 = YTrain;
load('training_dorm63.mat')
X63 = XTrain;
Y63 = YTrain;
load('training_dorm64.mat')
X64 = XTrain;
Y64 = YTrain;
load('training_dorm65.mat')
X65 = XTrain;
Y65 = YTrain;
load('training_dorm66.mat')
X66 = XTrain;
Y66 = YTrain;
load('training_dorm67.mat')
X67 = XTrain;
Y67 = YTrain;
load('training_dorm68.mat')
X68 = XTrain;
Y68 = YTrain;
load('training_dorm69.mat')
X69 = XTrain;
Y69 = YTrain;
load('training_dorm70.mat')
X70 = XTrain;
Y70 = YTrain;
load('training_dorm71.mat')
X71 = XTrain;
Y71 = YTrain;
load('training_dorm72.mat')
X72 = XTrain;
Y72 = YTrain;
load('training_dorm73.mat')
X73 = XTrain;
Y73 = YTrain;
load('training_dorm74.mat')
X74 = XTrain;
Y74 = YTrain;
load('training_dorm75.mat')
X75 = XTrain;
Y75 = YTrain;
load('training_dorm76.mat')
X76 = XTrain;
Y76 = YTrain;
load('training_dorm77.mat')
X77 = XTrain;
Y77 = YTrain;
load('training_dorm78.mat')
X78 = XTrain;
Y78 = YTrain;
load('training_dorm79.mat')
X79 = XTrain;
Y79 = YTrain;
load('training_dorm80.mat')
X80 = XTrain;
Y80 = YTrain;
load('training_dorm81.mat')
X81 = XTrain;
Y81 = YTrain;
load('training_dorm82.mat')
X82 = XTrain;
Y82 = YTrain;
load('training_dorm83.mat')
X83 = XTrain;
Y83 = YTrain;
load('training_dorm84.mat')
X84 = XTrain;
Y84 = YTrain;
load('training_dorm85.mat')
X85 = XTrain;
Y85 = YTrain;
load('training_dorm86.mat')
X86 = XTrain;
Y86 = YTrain;
load('training_dorm87.mat')
X87 = XTrain;
Y87 = YTrain;
load('training_dorm88.mat')
X88 = XTrain;
Y88 = YTrain;
load('training_dorm89.mat')
X89 = XTrain;
Y89 = YTrain;
load('training_dorm90.mat')
X90 = XTrain;
Y90 = YTrain;
load('training_dorm91.mat')
X91 = XTrain;
Y91 = YTrain;
load('training_dorm92.mat')
X92 = XTrain;
Y92 = YTrain;
load('training_dorm93.mat')
X93 = XTrain;
Y93 = YTrain;
load('training_dorm94.mat')
X94 = XTrain;
Y94 = YTrain;
load('training_dorm95.mat')
X95 = XTrain;
Y95 = YTrain;
load('training_dorm96.mat')
X96 = XTrain;
Y96 = YTrain;
load('training_dorm97.mat')
X97 = XTrain;
Y97 = YTrain;
load('training_dorm98.mat')
X98 = XTrain;
Y98 = YTrain;
load('training_dorm99.mat')
X99 = XTrain;
Y99 = YTrain;
XTrain = {X0, X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X17, X18, X19, X20, X21, X22, X23, X24, X25, X26, X27, X28, X29, X30, X31, X32, X33, X34, X35, X36, X37, X38, X39, X40, X41, X42, X43, X44, X45, X46, X47, X48, X49, X50, X51, X52, X53, X54, X55, X56, X57, X58, X59, X60, X61, X62, X63, X64, X65, X66, X67, X68, X69, X70, X71, X72, X73, X74, X75, X76, X77, X78, X79, X80, X81, X82, X83, X84, X85, X86, X87, X88, X89, X90, X91, X92, X93, X94, X95, X96, X97, X98, X99}';
YTrain = {Y0(:,2:end), Y1(:,2:end), Y2(:,2:end), Y3(:,2:end), Y4(:,2:end), Y5(:,2:end), Y6(:,2:end), Y7(:,2:end), Y8(:,2:end), Y9(:,2:end), Y10(:,2:end), Y11(:,2:end), Y12(:,2:end), Y13(:,2:end), Y14(:,2:end), Y15(:,2:end), Y16(:,2:end), Y17(:,2:end), Y18(:,2:end), Y19(:,2:end), Y20(:,2:end), Y21(:,2:end), Y22(:,2:end), Y23(:,2:end), Y24(:,2:end), Y25(:,2:end), Y26(:,2:end), Y27(:,2:end), Y28(:,2:end), Y29(:,2:end), Y30(:,2:end), Y31(:,2:end), Y32(:,2:end), Y33(:,2:end), Y34(:,2:end), Y35(:,2:end), Y36(:,2:end), Y37(:,2:end), Y38(:,2:end), Y39(:,2:end), Y40(:,2:end), Y41(:,2:end), Y42(:,2:end), Y43(:,2:end), Y44(:,2:end), Y45(:,2:end), Y46(:,2:end), Y47(:,2:end), Y48(:,2:end), Y49(:,2:end), Y50(:,2:end), Y51(:,2:end), Y52(:,2:end), Y53(:,2:end), Y54(:,2:end), Y55(:,2:end), Y56(:,2:end), Y57(:,2:end), Y58(:,2:end), Y59(:,2:end), Y60(:,2:end), Y61(:,2:end), Y62(:,2:end), Y63(:,2:end), Y64(:,2:end), Y65(:,2:end), Y66(:,2:end), Y67(:,2:end), Y68(:,2:end), Y69(:,2:end), Y70(:,2:end), Y71(:,2:end), Y72(:,2:end), Y73(:,2:end), Y74(:,2:end), Y75(:,2:end), Y76(:,2:end), Y77(:,2:end), Y78(:,2:end), Y79(:,2:end), Y80(:,2:end), Y81(:,2:end), Y82(:,2:end), Y83(:,2:end), Y84(:,2:end), Y85(:,2:end), Y86(:,2:end), Y87(:,2:end), Y88(:,2:end), Y89(:,2:end), Y90(:,2:end), Y91(:,2:end), Y92(:,2:end), Y93(:,2:end), Y94(:,2:end), Y95(:,2:end), Y96(:,2:end), Y97(:,2:end), Y98(:,2:end), Y99(:,2:end)}';
% XTrain = {X50, X51, X52, X53, X54, X55, X56, X57, X58, X59, X60, X61, X62, X63, X64, X65, X66, X67, X68, X69, X70, X71, X72, X73, X74, X75, X76, X77, X78, X79, X80, X81, X82, X83, X84, X85, X86, X87, X88, X89, X90, X91, X92, X93, X94, X95, X96, X97, X98, X99}';
% YTrain = {Y50(:,2:end), Y51(:,2:end), Y52(:,2:end), Y53(:,2:end), Y54(:,2:end), Y55(:,2:end), Y56(:,2:end), Y57(:,2:end), Y58(:,2:end), Y59(:,2:end), Y60(:,2:end), Y61(:,2:end), Y62(:,2:end), Y63(:,2:end), Y64(:,2:end), Y65(:,2:end), Y66(:,2:end), Y67(:,2:end), Y68(:,2:end), Y69(:,2:end), Y70(:,2:end), Y71(:,2:end), Y72(:,2:end), Y73(:,2:end), Y74(:,2:end), Y75(:,2:end), Y76(:,2:end), Y77(:,2:end), Y78(:,2:end), Y79(:,2:end), Y80(:,2:end), Y81(:,2:end), Y82(:,2:end), Y83(:,2:end), Y84(:,2:end), Y85(:,2:end), Y86(:,2:end), Y87(:,2:end), Y88(:,2:end), Y89(:,2:end), Y90(:,2:end), Y91(:,2:end), Y92(:,2:end), Y93(:,2:end), Y94(:,2:end), Y95(:,2:end), Y96(:,2:end), Y97(:,2:end), Y98(:,2:end), Y99(:,2:end)}';

XTrain_flipped = XTrain;
YTrain_flipped = YTrain;
% for j = 1:100
%     y = cell2mat(YTrain(j));
%     y(y == 1) = 0;
%     y(y > 1) = 1;
%     YTrain(j) = {y};
% end
% 
% YTrain = {categorical(cell2mat(YTrain(1))), categorical(cell2mat(YTrain(2))), categorical(cell2mat(YTrain(3))), categorical(cell2mat(YTrain(4))), categorical(cell2mat(YTrain(5))), categorical(cell2mat(YTrain(6))), categorical(cell2mat(YTrain(7))), categorical(cell2mat(YTrain(8))), categorical(cell2mat(YTrain(9))), categorical(cell2mat(YTrain(10))), categorical(cell2mat(YTrain(11))), categorical(cell2mat(YTrain(12))), categorical(cell2mat(YTrain(13))), categorical(cell2mat(YTrain(14))), categorical(cell2mat(YTrain(15))), categorical(cell2mat(YTrain(16))), categorical(cell2mat(YTrain(17))), categorical(cell2mat(YTrain(18))), categorical(cell2mat(YTrain(19))), categorical(cell2mat(YTrain(20))), categorical(cell2mat(YTrain(21))), categorical(cell2mat(YTrain(22))), categorical(cell2mat(YTrain(23))), categorical(cell2mat(YTrain(24))), categorical(cell2mat(YTrain(25))), categorical(cell2mat(YTrain(26))), categorical(cell2mat(YTrain(27))), categorical(cell2mat(YTrain(28))), categorical(cell2mat(YTrain(29))), categorical(cell2mat(YTrain(30))), categorical(cell2mat(YTrain(31))), categorical(cell2mat(YTrain(32))), categorical(cell2mat(YTrain(33))), categorical(cell2mat(YTrain(34))), categorical(cell2mat(YTrain(35))), categorical(cell2mat(YTrain(36))), categorical(cell2mat(YTrain(37))), categorical(cell2mat(YTrain(38))), categorical(cell2mat(YTrain(39))), categorical(cell2mat(YTrain(40))), categorical(cell2mat(YTrain(41))), categorical(cell2mat(YTrain(42))), categorical(cell2mat(YTrain(43))), categorical(cell2mat(YTrain(44))), categorical(cell2mat(YTrain(45))), categorical(cell2mat(YTrain(46))), categorical(cell2mat(YTrain(47))), categorical(cell2mat(YTrain(48))), categorical(cell2mat(YTrain(49))), categorical(cell2mat(YTrain(50))), categorical(cell2mat(YTrain(51))), categorical(cell2mat(YTrain(52))), categorical(cell2mat(YTrain(53))), categorical(cell2mat(YTrain(54))), categorical(cell2mat(YTrain(55))), categorical(cell2mat(YTrain(56))), categorical(cell2mat(YTrain(57))), categorical(cell2mat(YTrain(58))), categorical(cell2mat(YTrain(59))), categorical(cell2mat(YTrain(60))), categorical(cell2mat(YTrain(61))), categorical(cell2mat(YTrain(62))), categorical(cell2mat(YTrain(63))), categorical(cell2mat(YTrain(64))), categorical(cell2mat(YTrain(65))), categorical(cell2mat(YTrain(66))), categorical(cell2mat(YTrain(67))), categorical(cell2mat(YTrain(68))), categorical(cell2mat(YTrain(69))), categorical(cell2mat(YTrain(70))), categorical(cell2mat(YTrain(70))), categorical(cell2mat(YTrain(71))), categorical(cell2mat(YTrain(72))), categorical(cell2mat(YTrain(73))), categorical(cell2mat(YTrain(74))), categorical(cell2mat(YTrain(75))), categorical(cell2mat(YTrain(76))), categorical(cell2mat(YTrain(77))), categorical(cell2mat(YTrain(78))), categorical(cell2mat(YTrain(79))), categorical(cell2mat(YTrain(80))), categorical(cell2mat(YTrain(81))), categorical(cell2mat(YTrain(82))), categorical(cell2mat(YTrain(83))), categorical(cell2mat(YTrain(84))), categorical(cell2mat(YTrain(85))), categorical(cell2mat(YTrain(86))), categorical(cell2mat(YTrain(87))), categorical(cell2mat(YTrain(88))), categorical(cell2mat(YTrain(89))), categorical(cell2mat(YTrain(90))), categorical(cell2mat(YTrain(91))), categorical(cell2mat(YTrain(92))), categorical(cell2mat(YTrain(93))), categorical(cell2mat(YTrain(94))), categorical(cell2mat(YTrain(95))), categorical(cell2mat(YTrain(96))), categorical(cell2mat(YTrain(97))), categorical(cell2mat(YTrain(98))), categorical(cell2mat(YTrain(99)))}';

for i = 1:size(XTrain, 1)
    XTrain(i) = {(cell2mat(XTrain(i)) - 1.2e4) ./6.8e3};
    X = cell2mat(XTrain(i));
    X_flip_space = X(end:-1:1,:);
    XTrain_flipped(i) = {X_flip_space};
    Y = cell2mat(YTrain(i));
    Y(Y == 2) = 4;
    Y(Y == 3) = 2;
    Y(Y == 4) = 3;
    YTrain_flipped(i) = {Y};
end

XTrain = [XTrain; XTrain_flipped];
YTrain = [YTrain; YTrain_flipped];

XTrain_flipped = XTrain;
YTrain_flipped = YTrain;

for i = 1:size(XTrain, 1)
    X = cell2mat(XTrain(i));
    X_flip_time = X(:,end:-1:1);
    XTrain_flipped(i) = {X_flip_time};
    Y = cell2mat(YTrain(i));
    Y(Y == 2) = 4;
    Y(Y == 3) = 2;
    Y(Y == 4) = 3;
    YTrain_flipped(i) = {Y(:,end:-1:1)};
end

XTrain = [XTrain; XTrain_flipped];
YTrain = [YTrain; YTrain_flipped];

for i = 1:size(XTrain, 1)
    X = cell2mat(XTrain(i));
    prev = X(:,1);
    raw = X(:,2:end);
    l = size(prev, 1);
    new_X = zeros(3*l, 99);
    new_X_step = zeros(3*l, 1);
    
%     new_X = zeros(5*l, 99);
%     new_X_step = zeros(5*l, 1);
    for j=1:99
        new_X_step(1:l,:) = raw(:,j);
        lshift = circshift(prev, -1);
        rshift = circshift(prev, 1);
        rshift_raw = circshift(raw(:,j), 1);
        d = raw(:,j) - prev;
%         rshift_diff = circshift(d, 1);
%         new_X_step(l+1:2*l,:) = raw(:,j) - rshift_raw;
%         new_X_step(2*l+1:3*l,:) = d - rshift_diff;
%         new_X_step(3*l+1:4*l,:) = raw(:,j) - lshift;
%         new_X_step(4*l+1:5*l,:) = raw(:,j) - rshift;

        new_X_step(1*l+1:2*l,:) = raw(:,j) - lshift;
        new_X_step(2*l+1:3*l,:) = raw(:,j) - rshift;
        prev = raw(:,j);
        new_X(:,j) = new_X_step;
    end
    XTrain(i) = {new_X};
end

for i = 1:size(XTrain, 1)
    YTrain(i) = {categorical(cell2mat(YTrain(i)))};
end

save('TrainingData', 'XTrain', 'YTrain');